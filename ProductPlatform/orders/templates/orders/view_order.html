{% extends 'base.html' %}
{% load static %}


{% block content %}
    <section class="heading-order header-text" id="top">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h2>Заказ</h2>
                </div>
            </div>
        </div>
    </section>
    <section class="order" id="meetings">
        <div class="container">
            <div class="row order-content">
                <div class="col-lg-6 responses" style="padding-left: 0px; padding-right: 0px;">
                    <div class="respons">
                        <h4 class="h-responses">Отклики</h4>
                        <ul id="res">
                            {% for response_order in response_orders %}
                                <li class="col-lg-12 response"><a
                                        href="#">{{ response_order.response_user.comp_name }}</a>
                                    <div class="line">
                                        <div class="price">{{ response_order.price|floatformat:2 }} ₽</div>
                                        {% if not user.role == 'Supplier' %}
                                            <i data-bs-toggle="modal" data-bs-target="#staticBackdrop1"
                                               class="fa fa-check accept"></i>
                                            <i data-bs-toggle="modal" data-bs-target="#staticBackdrop2"
                                               class="fa fa-close cancel"></i>
                                        {% endif %}
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                        {% if not user.role == 'Supplier' %}
                            <!-- Modal -->
                            <div class="modal fade" id="staticBackdrop1" data-bs-backdrop="static"
                                 data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel"
                                 aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="staticBackdropLabel">Подтверждение</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            Вы действительно уверены, что хотите принять предложение?
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="accept-btn">Принять</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal fade" id="staticBackdrop2" data-bs-backdrop="static"
                                 data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel"
                                 aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="staticBackdropLabel">Подтверждение</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                    aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            Вы действительно уверены, что хотите отклонить предложение?
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="close-btn">Отклонить</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="row">
                        {% if user.role == 'Supplier' %}
                            <div class="order-response">
                                <div class="order">
                                    <div class="h-order col-lg-12">
                                        <div class="col-lg-2" style="width: 72px;"></div>
                                        <div class="col-lg-8 center">{{ order.name }}</div>
                                        <div class="date-position col-lg-2">
                                            С
                                            <div class="date date-start">
                                                <h6>Nov <span>9</span></h6>
                                            </div>
                                            До
                                            <div class="date">
                                                <h6>Nov <span>12</span></h6>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <label class="small mb-1" for="company">Компания</label>
                                        <div class="read_only order-info">
                                            {{ order.author.comp_name }} на сайте с {{ order.author.date_joined }}
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <label class="small mb-1" for="category">Категория</label>
                                        <div class="read_only order-info">
                                            {{ order.category }}
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <label class="small description mb-1" for="description">
                                            Описание заказа
                                        </label>
                                        <div class="form-control read_only order-desc">
                                            {{ order.description }}
                                        </div>
                                    </div>
                                </div>
                                <div class="order response-form">
                                    <form id="contact" action="" method="post">
                                        {% csrf_token %}
                                        <div class="col-lg-12">
                                            <fieldset>
                                                <label class="small mb-1" for="price-suggestion">Предложение</label>
                                                <input name="name" min="0" step="1" type="number"
                                                       id="price-suggestion"
                                                       placeholder="Предложение..." required="">
                                            </fieldset>
                                        </div>
                                        <div class="col-lg-12">
                                            <fieldset>
                                                <label class="small description mb-1" for="description">Описание</label>
                                                <textarea name="message" type="text" class="form-control"
                                                          id="description"
                                                          placeholder="Описание..." required=""></textarea>
                                            </fieldset>
                                        </div>
                                        <div class="col-lg-12 submit-btn">
                                            <fieldset>
                                                <button class="button button-login-reg del" type="submit"
                                                        id="submit-btn"
                                                        data-canceledresponse="false">
                                                    Откликнуться
                                                </button>
                                            </fieldset>
                                            <div style="display: none;" class="button del" id="edit-btn">
                                                Отменить отклик
                                            </div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        {% else %}
                            <div class="order">
                                <div class="h-order col-lg-12">
                                    <div class="col-lg-2" style="width: 72px;"></div>
                                    <div class="col-lg-8 center">{{ order.name }}</div>
                                    <div class="date-position col-lg-2">
                                        С
                                        <div class="date date-start">
                                            <h6>
                                                {{ order.create_at|date:'b' }}
                                                <span>
                                                    {{ order.create_at|date:'d' }}
                                                </span>
                                            </h6>
                                        </div>
                                        До
                                        <div class="date">
                                            <h6>
                                                {{ order.end_time|date:'b' }}
                                                <span>
                                                    {{ order.end_time|date:'d' }}
                                                </span>
                                            </h6>
                                        </div>
                                    </div>
                                </div>
                                <form id="contact" action="" method="post">
                                    {% csrf_token %}
                                    <div class="col-lg-12">
                                        <fieldset>
                                            <label class="small mb-1" for="company">Компания</label>
                                            <input name="name" class="read_only" readonly="readonly" type="text"
                                                   id="company"
                                                   required=""
                                                   value="{{ order.author.comp_name }} на сайте с {{ order.author.date_joined }}">
                                        </fieldset>
                                    </div>
                                    <div class="col-lg-12">
                                        <fieldset>
                                            <label class="small mb-1" for="category">Категория</label>
                                            <select name="name" type="text" id="category" class="form-select"
                                                    required="">
                                                <option value="value1">Значение 1</option>
                                                <option value="value2">Значение 2</option>
                                                <option value="value3">Значение 3</option>
                                            </select>
                                        </fieldset>
                                    </div>
                                    <div class="col-lg-12">
                                        <fieldset>
                                            <label class="small description mb-1" for="description">Описание</label>
                                            <textarea name="message" type="text" class="form-control" id="description"
                                                      placeholder="Описание..." required=""></textarea>
                                        </fieldset>
                                    </div>
                                    <div class="col-lg-12 submit-btn">
                                        <fieldset>
                                            <button style="display: none;"
                                                    class="button edit button-login-reg"
                                                    type="submit"
                                                    id="submit-btn">
                                                Сохранить
                                            </button>
                                        </fieldset>
                                        <div style="display: none;"
                                             class="button edit"
                                             id="edit-btn">
                                            Редактировать
                                        </div>
                                        <div class="button del">
                                            Удалить заказ
                                        </div>
                                    </div>
                                </form>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <div class="footer" style="margin-top: 10vh;">
            <p>© 2022 HORECA_MALL</p>
        </div>
    </section>
{% endblock %}

{% block morejs %}
    {% if not user.role == 'Supplier' %}
        <script src="{% static 'assets/js/order.js' %}"></script>
    {% else %}
        <script src="{% static 'assets/js/response.js' %}"></script>
    {% endif %}
{% endblock %}